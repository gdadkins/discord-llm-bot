{
  "assessment_date": "2025-06-16T16:33:36",
  "total_violations": 15,
  "violations_by_severity": {
    "high": 5,
    "medium": 7,
    "low": 3
  },
  "violations": [
    {
      "id": "V001",
      "type": "SOLID_SRP",
      "severity": "high",
      "pattern": "God Class",
      "file": "src/services/base/BaseService.ts",
      "lines": "1-1223",
      "description": "BaseService violates Single Responsibility Principle",
      "details": {
        "responsibilities": [
          "Timer management (lines 380-909)",
          "Lifecycle management (lines 189-302)",
          "Resource management (lines 100-104, 970-1077)",
          "Health monitoring (lines 303-377)",
          "Event handling (lines 1174-1193)"
        ],
        "line_count": 1223,
        "methods_count": 45,
        "complexity": "very_high"
      },
      "impact": "Difficult to maintain, test, and extend",
      "recommendation": "Decompose into separate components using composition pattern"
    },
    {
      "id": "V002",
      "type": "SOLID_DIP",
      "severity": "high",
      "pattern": "Direct Instantiation",
      "file": "src/services/gemini/GeminiService.ts",
      "lines": "108-133",
      "description": "GeminiService directly instantiates concrete classes",
      "details": {
        "violations": [
          "new GeminiAPIClient() at line 108",
          "new GeminiContextProcessor() at line 114",
          "new GeminiResponseHandler() at line 130"
        ]
      },
      "impact": "Tight coupling, reduced testability",
      "recommendation": "Accept these dependencies through constructor injection"
    },
    {
      "id": "V003",
      "type": "SOLID_DIP",
      "severity": "high",
      "pattern": "Hidden Dependency",
      "file": "src/services/analytics/EventTrackingService.ts",
      "lines": "101",
      "description": "EventTrackingService creates EventBatchingService internally",
      "details": {
        "violation": "new EventBatchingService(this.database)",
        "hidden_dependency": "EventBatchingService"
      },
      "impact": "Hidden dependencies reduce flexibility and testability",
      "recommendation": "Inject EventBatchingService as a dependency"
    },
    {
      "id": "V004",
      "type": "FILE_SIZE",
      "severity": "high",
      "pattern": "Oversized File",
      "file": "src/services/base/BaseService.ts",
      "lines": "1223",
      "description": "File exceeds 700 line limit",
      "details": {
        "current_lines": 1223,
        "max_allowed": 700,
        "excess": 523
      },
      "impact": "Violates CLAUDE.md code organization standards",
      "recommendation": "Split into multiple focused files"
    },
    {
      "id": "V005",
      "type": "SOLID_OCP",
      "severity": "medium",
      "pattern": "Modification Required",
      "file": "src/services/base/BaseService.ts",
      "lines": "380-909",
      "description": "Timer functionality requires BaseService modification",
      "details": {
        "issue": "New timer features require modifying BaseService",
        "affected_methods": ["createInterval", "createTimeout", "createCoalescedInterval"]
      },
      "impact": "Violates Open/Closed Principle",
      "recommendation": "Extract timer management to separate component"
    },
    {
      "id": "V006",
      "type": "COUPLING",
      "severity": "medium",
      "pattern": "Tight Coupling",
      "file": "src/services/gemini/GeminiService.ts",
      "lines": "52-56",
      "description": "GeminiService tightly coupled to internal modules",
      "details": {
        "coupled_modules": ["GeminiAPIClient", "GeminiContextProcessor", "GeminiResponseHandler"],
        "coupling_type": "concrete_dependency"
      },
      "impact": "Cannot swap implementations without service modification",
      "recommendation": "Use interfaces for all internal dependencies"
    },
    {
      "id": "V007",
      "type": "LAW_OF_DEMETER",
      "severity": "medium",
      "pattern": "Train Wreck",
      "file": "src/services/base/BaseService.ts",
      "lines": "1211-1222",
      "description": "Deep method chaining in getServiceStatus",
      "details": {
        "chain": "this.resources.getResourceStats()",
        "depth": 2
      },
      "impact": "Increased coupling between components",
      "recommendation": "Return simple data structures or use facades"
    },
    {
      "id": "V008",
      "type": "DRY",
      "severity": "medium",
      "pattern": "Code Duplication",
      "file": "src/services/base/BaseService.ts",
      "lines": "404-498",
      "description": "Similar timer creation logic duplicated",
      "details": {
        "duplicated_in": ["createInterval", "createTimeout"],
        "similar_code_blocks": 2
      },
      "impact": "Maintenance overhead, potential inconsistencies",
      "recommendation": "Extract common timer creation logic"
    },
    {
      "id": "V009",
      "type": "REPOSITORY",
      "severity": "medium",
      "pattern": "Data Access in Service",
      "file": "src/services/analytics/EventTrackingService.ts",
      "lines": "158-177",
      "description": "Direct database access in service layer",
      "details": {
        "sql_queries": true,
        "database_coupling": "better-sqlite3"
      },
      "impact": "Service layer coupled to data access implementation",
      "recommendation": "Implement repository pattern for data access"
    },
    {
      "id": "V010",
      "type": "INTERFACE_SEGREGATION",
      "severity": "low",
      "pattern": "Optional Interface Methods",
      "file": "src/services/base/BaseService.ts",
      "lines": "151-157",
      "description": "Optional override methods suggest interface could be segregated",
      "details": {
        "optional_methods": ["isHealthy", "getHealthErrors", "buildHealthStatus"]
      },
      "impact": "Services may implement unnecessary methods",
      "recommendation": "Consider separate health monitoring interface"
    },
    {
      "id": "V011",
      "type": "DESIGN_PATTERN",
      "severity": "low",
      "pattern": "Missing Builder",
      "file": "src/services/gemini/GeminiService.ts",
      "lines": "73-88",
      "description": "Complex constructor with many dependencies",
      "details": {
        "parameter_count": 11,
        "nested_object": true
      },
      "impact": "Complex object construction",
      "recommendation": "Implement Builder pattern for service construction"
    },
    {
      "id": "V012",
      "type": "ABSTRACTION",
      "severity": "medium",
      "pattern": "Leaky Abstraction",
      "file": "src/services/base/BaseService.ts",
      "lines": "699-758",
      "description": "Timer coalescing implementation details exposed",
      "details": {
        "exposed_internals": ["coalescingGroups", "COALESCING_INTERVAL"],
        "abstraction_level": "implementation"
      },
      "impact": "Internal implementation details visible to subclasses",
      "recommendation": "Hide coalescing details behind cleaner interface"
    },
    {
      "id": "V013",
      "type": "CIRCULAR_DEPENDENCY_RISK",
      "severity": "medium",
      "pattern": "Service Inter-dependency",
      "file": "src/services/interfaces/serviceFactory.ts",
      "lines": "299-329",
      "description": "Complex service wiring increases circular dependency risk",
      "details": {
        "interconnected_services": ["aiService", "healthMonitor", "gracefulDegradation"],
        "bidirectional_dependencies": true
      },
      "impact": "Potential for circular dependencies as system grows",
      "recommendation": "Use event-based communication or mediator pattern"
    },
    {
      "id": "V014",
      "type": "FACTORY_PATTERN",
      "severity": "low",
      "pattern": "Factory Method Inconsistency",
      "file": "src/services/interfaces/serviceFactory.ts",
      "lines": "185-188",
      "description": "Legacy createAIService throws error instead of delegating",
      "details": {
        "inconsistent_method": "createAIService",
        "expected_behavior": "delegate to createAIServiceWithDependencies"
      },
      "impact": "Inconsistent factory interface",
      "recommendation": "Update to delegate or mark as deprecated"
    },
    {
      "id": "V015",
      "type": "ERROR_HANDLING",
      "severity": "high",
      "pattern": "Silent Error Suppression",
      "file": "src/services/base/BaseService.ts",
      "lines": "1175-1182",
      "description": "Lifecycle event errors caught but not properly handled",
      "details": {
        "suppressed_errors": "lifecycle event handler errors",
        "logging_only": true
      },
      "impact": "Critical errors may go unnoticed",
      "recommendation": "Implement proper error propagation or recovery"
    }
  ],
  "patterns_summary": {
    "most_common_violations": [
      {
        "pattern": "SOLID Principle Violations",
        "count": 6,
        "percentage": 40
      },
      {
        "pattern": "Coupling Issues",
        "count": 4,
        "percentage": 26.7
      },
      {
        "pattern": "Code Organization",
        "count": 3,
        "percentage": 20
      }
    ],
    "affected_components": {
      "BaseService": 8,
      "GeminiService": 3,
      "EventTrackingService": 2,
      "ServiceFactory": 2
    }
  },
  "improvement_metrics": {
    "if_fixed": {
      "architecture_score_increase": 1.5,
      "maintainability_increase": "35%",
      "testability_increase": "40%",
      "projected_score": 9.0
    },
    "effort_estimation": {
      "high_priority_hours": 40,
      "medium_priority_hours": 24,
      "low_priority_hours": 8,
      "total_hours": 72
    }
  }
}